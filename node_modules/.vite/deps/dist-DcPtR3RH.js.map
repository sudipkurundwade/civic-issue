{"version":3,"file":"dist-DcPtR3RH.js","names":[],"sources":["../../@radix-ui/react-roving-focus/dist/index.mjs"],"sourcesContent":["\"use client\";\n\n// src/roving-focus-group.tsx\nimport * as React from \"react\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { createCollection } from \"@radix-ui/react-collection\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useId } from \"@radix-ui/react-id\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useControllableState } from \"@radix-ui/react-use-controllable-state\";\nimport { useDirection } from \"@radix-ui/react-direction\";\nimport { jsx } from \"react/jsx-runtime\";\nvar ENTRY_FOCUS = \"rovingFocusGroup.onEntryFocus\";\nvar EVENT_OPTIONS = { bubbles: false, cancelable: true };\nvar GROUP_NAME = \"RovingFocusGroup\";\nvar [Collection, useCollection, createCollectionScope] = createCollection(GROUP_NAME);\nvar [createRovingFocusGroupContext, createRovingFocusGroupScope] = createContextScope(\n  GROUP_NAME,\n  [createCollectionScope]\n);\nvar [RovingFocusProvider, useRovingFocusContext] = createRovingFocusGroupContext(GROUP_NAME);\nvar RovingFocusGroup = React.forwardRef(\n  (props, forwardedRef) => {\n    return /* @__PURE__ */ jsx(Collection.Provider, { scope: props.__scopeRovingFocusGroup, children: /* @__PURE__ */ jsx(Collection.Slot, { scope: props.__scopeRovingFocusGroup, children: /* @__PURE__ */ jsx(RovingFocusGroupImpl, { ...props, ref: forwardedRef }) }) });\n  }\n);\nRovingFocusGroup.displayName = GROUP_NAME;\nvar RovingFocusGroupImpl = React.forwardRef((props, forwardedRef) => {\n  const {\n    __scopeRovingFocusGroup,\n    orientation,\n    loop = false,\n    dir,\n    currentTabStopId: currentTabStopIdProp,\n    defaultCurrentTabStopId,\n    onCurrentTabStopIdChange,\n    onEntryFocus,\n    preventScrollOnEntryFocus = false,\n    ...groupProps\n  } = props;\n  const ref = React.useRef(null);\n  const composedRefs = useComposedRefs(forwardedRef, ref);\n  const direction = useDirection(dir);\n  const [currentTabStopId, setCurrentTabStopId] = useControllableState({\n    prop: currentTabStopIdProp,\n    defaultProp: defaultCurrentTabStopId ?? null,\n    onChange: onCurrentTabStopIdChange,\n    caller: GROUP_NAME\n  });\n  const [isTabbingBackOut, setIsTabbingBackOut] = React.useState(false);\n  const handleEntryFocus = useCallbackRef(onEntryFocus);\n  const getItems = useCollection(__scopeRovingFocusGroup);\n  const isClickFocusRef = React.useRef(false);\n  const [focusableItemsCount, setFocusableItemsCount] = React.useState(0);\n  React.useEffect(() => {\n    const node = ref.current;\n    if (node) {\n      node.addEventListener(ENTRY_FOCUS, handleEntryFocus);\n      return () => node.removeEventListener(ENTRY_FOCUS, handleEntryFocus);\n    }\n  }, [handleEntryFocus]);\n  return /* @__PURE__ */ jsx(\n    RovingFocusProvider,\n    {\n      scope: __scopeRovingFocusGroup,\n      orientation,\n      dir: direction,\n      loop,\n      currentTabStopId,\n      onItemFocus: React.useCallback(\n        (tabStopId) => setCurrentTabStopId(tabStopId),\n        [setCurrentTabStopId]\n      ),\n      onItemShiftTab: React.useCallback(() => setIsTabbingBackOut(true), []),\n      onFocusableItemAdd: React.useCallback(\n        () => setFocusableItemsCount((prevCount) => prevCount + 1),\n        []\n      ),\n      onFocusableItemRemove: React.useCallback(\n        () => setFocusableItemsCount((prevCount) => prevCount - 1),\n        []\n      ),\n      children: /* @__PURE__ */ jsx(\n        Primitive.div,\n        {\n          tabIndex: isTabbingBackOut || focusableItemsCount === 0 ? -1 : 0,\n          \"data-orientation\": orientation,\n          ...groupProps,\n          ref: composedRefs,\n          style: { outline: \"none\", ...props.style },\n          onMouseDown: composeEventHandlers(props.onMouseDown, () => {\n            isClickFocusRef.current = true;\n          }),\n          onFocus: composeEventHandlers(props.onFocus, (event) => {\n            const isKeyboardFocus = !isClickFocusRef.current;\n            if (event.target === event.currentTarget && isKeyboardFocus && !isTabbingBackOut) {\n              const entryFocusEvent = new CustomEvent(ENTRY_FOCUS, EVENT_OPTIONS);\n              event.currentTarget.dispatchEvent(entryFocusEvent);\n              if (!entryFocusEvent.defaultPrevented) {\n                const items = getItems().filter((item) => item.focusable);\n                const activeItem = items.find((item) => item.active);\n                const currentItem = items.find((item) => item.id === currentTabStopId);\n                const candidateItems = [activeItem, currentItem, ...items].filter(\n                  Boolean\n                );\n                const candidateNodes = candidateItems.map((item) => item.ref.current);\n                focusFirst(candidateNodes, preventScrollOnEntryFocus);\n              }\n            }\n            isClickFocusRef.current = false;\n          }),\n          onBlur: composeEventHandlers(props.onBlur, () => setIsTabbingBackOut(false))\n        }\n      )\n    }\n  );\n});\nvar ITEM_NAME = \"RovingFocusGroupItem\";\nvar RovingFocusGroupItem = React.forwardRef(\n  (props, forwardedRef) => {\n    const {\n      __scopeRovingFocusGroup,\n      focusable = true,\n      active = false,\n      tabStopId,\n      children,\n      ...itemProps\n    } = props;\n    const autoId = useId();\n    const id = tabStopId || autoId;\n    const context = useRovingFocusContext(ITEM_NAME, __scopeRovingFocusGroup);\n    const isCurrentTabStop = context.currentTabStopId === id;\n    const getItems = useCollection(__scopeRovingFocusGroup);\n    const { onFocusableItemAdd, onFocusableItemRemove, currentTabStopId } = context;\n    React.useEffect(() => {\n      if (focusable) {\n        onFocusableItemAdd();\n        return () => onFocusableItemRemove();\n      }\n    }, [focusable, onFocusableItemAdd, onFocusableItemRemove]);\n    return /* @__PURE__ */ jsx(\n      Collection.ItemSlot,\n      {\n        scope: __scopeRovingFocusGroup,\n        id,\n        focusable,\n        active,\n        children: /* @__PURE__ */ jsx(\n          Primitive.span,\n          {\n            tabIndex: isCurrentTabStop ? 0 : -1,\n            \"data-orientation\": context.orientation,\n            ...itemProps,\n            ref: forwardedRef,\n            onMouseDown: composeEventHandlers(props.onMouseDown, (event) => {\n              if (!focusable) event.preventDefault();\n              else context.onItemFocus(id);\n            }),\n            onFocus: composeEventHandlers(props.onFocus, () => context.onItemFocus(id)),\n            onKeyDown: composeEventHandlers(props.onKeyDown, (event) => {\n              if (event.key === \"Tab\" && event.shiftKey) {\n                context.onItemShiftTab();\n                return;\n              }\n              if (event.target !== event.currentTarget) return;\n              const focusIntent = getFocusIntent(event, context.orientation, context.dir);\n              if (focusIntent !== void 0) {\n                if (event.metaKey || event.ctrlKey || event.altKey || event.shiftKey) return;\n                event.preventDefault();\n                const items = getItems().filter((item) => item.focusable);\n                let candidateNodes = items.map((item) => item.ref.current);\n                if (focusIntent === \"last\") candidateNodes.reverse();\n                else if (focusIntent === \"prev\" || focusIntent === \"next\") {\n                  if (focusIntent === \"prev\") candidateNodes.reverse();\n                  const currentIndex = candidateNodes.indexOf(event.currentTarget);\n                  candidateNodes = context.loop ? wrapArray(candidateNodes, currentIndex + 1) : candidateNodes.slice(currentIndex + 1);\n                }\n                setTimeout(() => focusFirst(candidateNodes));\n              }\n            }),\n            children: typeof children === \"function\" ? children({ isCurrentTabStop, hasTabStop: currentTabStopId != null }) : children\n          }\n        )\n      }\n    );\n  }\n);\nRovingFocusGroupItem.displayName = ITEM_NAME;\nvar MAP_KEY_TO_FOCUS_INTENT = {\n  ArrowLeft: \"prev\",\n  ArrowUp: \"prev\",\n  ArrowRight: \"next\",\n  ArrowDown: \"next\",\n  PageUp: \"first\",\n  Home: \"first\",\n  PageDown: \"last\",\n  End: \"last\"\n};\nfunction getDirectionAwareKey(key, dir) {\n  if (dir !== \"rtl\") return key;\n  return key === \"ArrowLeft\" ? \"ArrowRight\" : key === \"ArrowRight\" ? \"ArrowLeft\" : key;\n}\nfunction getFocusIntent(event, orientation, dir) {\n  const key = getDirectionAwareKey(event.key, dir);\n  if (orientation === \"vertical\" && [\"ArrowLeft\", \"ArrowRight\"].includes(key)) return void 0;\n  if (orientation === \"horizontal\" && [\"ArrowUp\", \"ArrowDown\"].includes(key)) return void 0;\n  return MAP_KEY_TO_FOCUS_INTENT[key];\n}\nfunction focusFirst(candidates, preventScroll = false) {\n  const PREVIOUSLY_FOCUSED_ELEMENT = document.activeElement;\n  for (const candidate of candidates) {\n    if (candidate === PREVIOUSLY_FOCUSED_ELEMENT) return;\n    candidate.focus({ preventScroll });\n    if (document.activeElement !== PREVIOUSLY_FOCUSED_ELEMENT) return;\n  }\n}\nfunction wrapArray(array, startIndex) {\n  return array.map((_, index) => array[(startIndex + index) % array.length]);\n}\nvar Root = RovingFocusGroup;\nvar Item = RovingFocusGroupItem;\nexport {\n  Item,\n  Root,\n  RovingFocusGroup,\n  RovingFocusGroupItem,\n  createRovingFocusGroupScope\n};\n//# sourceMappingURL=index.mjs.map\n"],"mappings":"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"}